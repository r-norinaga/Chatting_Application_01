<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
layout:decorate="~{actual/layout/layout}">
	<head>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
		<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
		<script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}" defer></script>
		<meta charset="UTF-8">
		<title th:text="#{talk.title.room.roomSearchResult}"></title>
	</head>
	<body>
		<div layout:fragment="content">
			<h1>チャットアプリ</h1>
			<h2>トークルーム検索結果</h2>
			<table border="1" class="table table-bordered">
				<tr>
					<thead>
						<th>トークルーム名</th>
						<th>作成日時</th>
						<th>ボタン</th>
					</thead>
				</tr>
				<tbody>
					
						
							<tr class="room" th:each="room:${roomListEntered}">
								
										
									
								
									<input type="hidden" th:name="roomId" th:value="${room.roomId}"/>
									<td th:text="${room.roomName}"></td>
									<td th:text="*{#dates.format(new java.util.Date(room.createdAt), 'yyyy/MM/dd HH:mm')}"></td>
									<td>
										<a class="btn btn-primary" th:href="@{/message/messageList(roomId=${room.roomId})}">閲覧</a>
<!-- 
									<div th:each="roomUser, stat:${room.roomUserList}">
											<th:block th:if="${loginUser.userId == roomUser.userId}">
												<a class="btn btn-primary" th:value="${roomUser.userId}" th:href="@{/message/messageList(roomId=${room.roomId})}">閲覧</a>
											</th:block>
											
											<th:block th:unless="${loginUser.userId == roomUser.userId}">
													
												<th:block th:if="${stat.index} == 0">
													<a class="btn btn-primary" th:value="${roomUser.userId}">入室</a>
												</th:block>
												<th:block th:unless="${stat.index} == 0">
													<th:block th:if="${room.roomUserList[stat.index-1].roomId} == ${roomUser.roomId}">	
													</th:block>
													<th:block th:unless="${room.roomUserList[stat.index-1].roomId} == ${roomUser.roomId}">
														<a class="btn btn-primary" th:value="${roomUser.userId}">入室</a>
													</th:block>
												</th:block>
											</th:block>
										</div>
	
	
	
	
	
 -->
										
										
									</td>
								
									
								
		
								
								
							</tr>
							
							
							<tr class="room" th:each="room:${roomListNotEntered}">
								<form method="post" th:action="@{/talk/enterARoom}">
									<input type="hidden" th:name="roomId" th:value="${room.roomId}"/>
									<input type="hidden" th:name="userId" th:value="${loginUser.userId}"/>
									<td th:text="${room.roomName}"></td>
									<td th:text="*{#dates.format(new java.util.Date(room.createdAt), 'yyyy/MM/dd HH:mm')}"></td>
									<td>
										<button class="btn btn-primary">入室</button>
<!-- 
										<a class="btn btn-primary" th:href="@{/talk/enterARoom(roomId=${room.roomId}, userId=${loginUser.userId})}">入室</a>
 -->

									</td>
								</form>
							</tr>
						
						
						
						
					
					
					
				</tbody>
				
				
			</table>
			
		</div>
	</body>
</html>